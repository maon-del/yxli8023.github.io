---
title: 构建三角形或者平行四边形点阵
tags: Fortran Study
layout: article
license: true
toc: true
key: a20200827
header:
  theme: dark
  background: 'linear-gradient(135deg, rgb(34, 139, 87), rgb(139, 34, 139))'
article_header:
  type: overlay
  theme: dark
  background_color: '#123'
  background_image: false
pageview: true
sitemap: true
mathjax: true
author: YuXuan
show_author_profile: true
---
平时在做紧束缚模型的时候，都是在n*n的点阵上进行的，但是有时候可能也需要在三角形或者平行四边形样式的点阵上去计算一些性质，正好趁手头空闲就把这个做了一下，还是非常的简单。
<!--more-->
# 正方+三角
```fortran
	program e1
	implicit none
	integer kn
	real pi,dk
	complex im
	parameter(kn = 10,pi = 3.1415926535,im = (0.0,1.0))
	integer m1,m2,m3
	real t1,t2
	complex re1,re2
	call cpu_time(t1) ! 获取当前系统时间
	open(12,file="squ.dat")
	open(13,file="tri.dat")
	do m1 = 1,kn
		do m2 = m1,m1+10
			write(12,*)m1,m2,sqrt(1.0*m1+m2)
		end do
	end do
	!----------------------------
	do m1 = 1,kn
		do m2 = 1,m1
			write(13,*)m1,m2,sqrt(1.0*m1+m2)
		end do
	end do
	close(12)
	close(13)
	call cpu_time(t2)
	stop
	end program e1
```

![png](/assets/images/Fortran/triangle.png){:width="330px",:height="495px"}![png](/assets/images/Fortran/square.png){:width="330px",:height="495px"}

# 六边形区域
```fortran
! Author:YuXuanLi
! E-Mail:yxli406@gmail.com
! Graphene BZ plot
    module pub
    implicit none
    complex,parameter::im = (0.0,1.0) 
    real,parameter::pi = 3.14159265359
    integer n0  ! n0 边形
    real r0     ! 外接圆半径
    end module pub
!========== PROGRAM START ==========================
    program sol
    use pub
    call BZ()
    stop
    end program sol
!===================================================
    subroutine BZ()
    use pub
    real dx,dy,d0
    d0 = 0.01
    open(20,file="graphene-BZ.dat")
    do dx = -1.0,-0.5,d0
        do dy = -sqrt(3.0)*dx - sqrt(3.0),sqrt(3.0)*dx + sqrt(3.0),d0
            write(20,*)dx,dy,cos(sin(dx*dy))
        end do
    end do
    do dx = -0.5,0.5,d0
        do dy = -sqrt(3.0)/2.0,sqrt(3.0)/2,d0
            write(20,*)dx,dy,cos(sin(dx*dy))
        end do
    end do
    do dx = 0.5,1.0,d0
        do dy = sqrt(3.0)*dx - sqrt(3.0),-sqrt(3.0)*dx + sqrt(3.0),d0
            write(20,*)dx,dy,cos(sin(dx*dy))
        end do
    end do
    return  
    end subroutine BZ
```
绘图程序

```shell
set encoding iso_8859_1
#set terminal  postscript enhanced color
#set output 'arc_r.eps'
#set terminal pngcairo truecolor enhanced  font ",50" size 1920, 1680
set terminal png truecolor enhanced font ",50" size 1920, 1920
set output 'density.png'
set palette defined ( -10 "#194eff", 0 "white", 10 "red" )
#set palette defined ( -10 "blue", 0 "white", 10 "red" )
#set palette rgbformulae 33,13,10
unset ztics
unset key
set pm3d
set border lw 6
#set size ratio -1
set size 1,1 # 图片比列
set view map
set xtics
set ytics
#set xlabel "K_1 (1/{\305})"
set xlabel "X_1"
#set ylabel "K_2 (1/{\305})"
set ylabel "Y"
set ylabel offset 1, 0
set colorbox
set xrange [-1:1]
set yrange [-1:1]
set pm3d interpolate 4,4
#splot 'wavenorm.dat' u 1:2:3 w pm3d
splot 'hex.dat' u 1:2:3 w pm3d
#splot 'sq45.dat' u 1:2:3 w pm3d
```

![png](/assets/images/Fortran/honeycomb.png){:width="330px",:height="495px"}

# 正方旋转$45^o$
```fortran
! Author:YuXuanLi
! E-Mail:yxli406@gmail.com
! Graphene BZ plot
    module pub
    implicit none
    complex,parameter::im = (0.0,1.0) 
    real,parameter::pi = 3.14159265359
    end module pub
!========== PROGRAM START ==========================
    program sol
    use pub
    call sq45()
    stop
    end program sol
!============================================================================
    subroutine sq45()
    use pub
    real dx,dy,d0,ang,k0,b0
    real nx
    nx = 10.0
    ang = pi/4.0
    d0 = 0.1
    k0 = 2*sin(ang)  ! 斜率
    b0 = k0*nx    ! 截距
    
    open(22,file="sq45.dat")
    do dx = -nx,0.0,d0
        do dy = -(k0*dx + b0),k0*dx + b0,d0
            write(22,*)dx,dy,cos(dx*dy)
        end do
        write(22,*)""
    end do
    do dx = 0.0,nx,d0
        do dy = -(-k0*dx + b0),-k0*dx + b0,d0
            write(22,*)dx,dy,cos(dx*dy)
        end do
        write(22,*)""
    end do
    close(22)
    return
    end subroutine sq45
```

因为撒点太密的话,数据文件会会比较大,此时推荐使用**gnuplot**绘图

```shell
set encoding iso_8859_1
#set terminal  postscript enhanced color
#set output 'arc_r.eps'
#set terminal pngcairo truecolor enhanced  font ",50" size 1920, 1680
set terminal png truecolor enhanced font ",50" size 1920, 1920
set output 'density.png'
set palette defined ( -10 "#194eff", 0 "white", 10 "red" )
#set palette defined ( -10 "blue", 0 "white", 10 "red" )
#set palette rgbformulae 33,13,10
unset ztics
unset key
set pm3d
set border lw 6
#set size ratio -1
set size 1,1 # 图片比列
set view map
set xtics
set ytics
#set xlabel "K_1 (1/{\305})"
set xlabel "X_1"
#set ylabel "K_2 (1/{\305})"
set ylabel "Y"
set ylabel offset 1, 0
set colorbox
set xrange [-10:10]
set yrange [-15:15]
set pm3d interpolate 4,4
#splot 'wavenorm.dat' u 1:2:3 w pm3d
#splot 'wavenorm.dat' u 1:2:3 w pm3d
splot 'sq45.dat' u 1:2:3 w pm3d
```

![png](/assets/images/Fortran/square45.png){:width="330px",:height="495px"}